{% include 'includes/messages.html' %}
{% include 'includes/header.html' %}

{% load static %}

<head>
    <link rel="stylesheet" type="text/css" href="{% static '../static/css/style.css' %}" />
	<!-- <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/bootstrap.css' %}"> -->
</head>



<div class="container" id="container">
	<div class="nav-tabs" id="profile-tabs">
		<a class="nav-tab activate" id="nav-profile-tab" onclick="openTab(event, 'nav-profile')">Profile</a>
		{% if edit_access %}
		<a class="nav-tab" id="nav-edit-tab"  onclick="openTab(event, 'nav-edit')">Edit Profile</a>
		{% endif %}
		<a class="nav-tab" id="nav-hsitory-tab"  onclick="getProfileHistory();">History</a>
		
	</div>

	{% if edit_access %}
	<div class="form-container profile-edit-container tabcontent" id="nav-edit" style="display: none;">
		<form action="{% url 'account:profile_page' username %}" method = "POST">
			{% csrf_token %}
			<h1>Edit Profile</h1><a></a>
			<input type="password" placeholder="Current Password" name ="old_password" required/>
            <input type="password" placeholder="New Password" name ="password1" required/>
			<input type="password" placeholder="Confirm New Password" name ="password2" required/>
			<button type = "submit" value="Confirm" name="account_info">Confirm</button>
		</form>
	</div>
	
	{% endif %}

	<div class="form-container profile-container tabcontent" id="nav-profile">
		<div class="profile-pic-container">
		<form action="." method = "POST">
			{% csrf_token %}
			<div class="image-container">
				<img class="image" src="https://st3.depositphotos.com/15648834/17930/v/600/depositphotos_179308454-stock-illustration-unknown-person-silhouette-glasses-profile.jpg" alt="Image">
			</div>
			<a></a>
			<!--add change picture option-->
			<button type="submit" value="" name="">Change Picture</button>
		</form>
		</div>
		<div class="profile-container tabcontent profile-info-container"> 
			<h1>Profile Information</h1><a></a>
				{% if request.user.is_authenticated %}
				Username<input type="text" value="{{ username }}" readonly>
				<a></a>
				Email<input type="text" value="{{ email }}" readonly>
				{% endif %}
				<a></a>
				<!--change here-->
				<button class="ghost" id="editProfile">Edit Profile</button>
				</a>
				<!--this js script must be placed at the end of the file AFTER buttons-->


		</div>
	</div>


	<div class="form-container tabcontent user-history-container" id="nav-history" style="display: none;">
        <h2>User History</h2>
		<div class="history-content">
			<ul>
				<!-- this div will contain the profile history of user, called from ajax -->
				<div id="profileHistory">

				</div>
				
			</ul>

		</div>
       
    </div>
</div>

<script type="text/javascript" src="{% static '../static/js/profile.js' %}"></script>



{% block scripts %}

{% include "includes/ajax_functions.html" %}

{% endblock scripts %}

<script>

function getProfileHistory(){
		openTab(event, 'nav-history');
        $.ajax({
            url: "{% url 'account:profile_history_page' username %}",
            type: "GET",
            success: function(resp){
                $("#profileHistory").html(resp);
				// implement change_profile_url
            },
            error: function(resp){
                console.log("getProfileInfo error");
            }
        });
    }



</script>
