<div>
{% for friend in friends_data %}
<li>
    <div class="friend-request-container">
    
        <div class="profile-picture-container">
            <a href="{% url 'account:profile_page' friend.friend.username %}">
            <img src="{{ friend.friend.profile_picture.url }}" class="profile-picture" alt="{{ friend.username }}" height="50px" width="50px">
            </a>
            <p>{{ friend.friend.username }}</p>
        </div>
        {% if block_access %}
        {% if friend.connection_status == "Accepted" %}
        <div class="block-button-container">
            
            <a class="accept" onclick="blockFriend(event, '{{ friend.connection_id }}')">Block</a>

        </div>
        {% endif %}
        {% endif %}

        {% if block_access %}
        {% if friend.connection_status == "Blocked" %}

        <div class="block-button-container">
            
            <a class="accept" onclick="unblockFriend(event, '{{ friend.connection_id }}')">Unblock</a>

        </div>

        {% endif %}
        {% endif %}
    </div>
</li>

{% endfor %}

</div>


<script>

function blockFriend(event, connection_id) {
    event.preventDefault();
    $.ajax({
        url: "{% url 'account:block_friend' connection_id=1 %}".replace(/1/, connection_id.toString()),
        type: "GET",
        dataType: "json",
        success: function(response) {
            getFriends();
        },
        error: function(xhr, reported, error) {
            console.log("Error accepting friend request");
        },
    });
}

function unblockFriend(event, connection_id) {
    event.preventDefault();
    $.ajax({
        url: "{% url 'account:unblock_friend' connection_id=1 %}".replace(/1/, connection_id.toString()),
        type: "GET",
        dataType: "json",
        success: function(response) {
            getFriends();
        },
        error: function(xhr, reported, error) {
            console.log("Error accepting friend request");
        },
    });
}


</script>
