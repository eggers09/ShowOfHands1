{% load static %}
    <div class="chat-header clearfix">
        <div class="row">
            <div class="col-lg-6">
                <a href="javascript:void(0);" data-toggle="modal" data-target="#view_info">
                    <img src="https://bootdey.com/img/Content/avatar/avatar2.png" alt="avatar">
                </a>
                <div class="chat-about">
                    <h6 class="m-b-0">{{ friend_name }}</h6>
                    <!-- get last login or something -->
                    <small>Online</small>
                </div>
            </div>
        </div>
    </div>
    <div class="chat-history">
        <ul class="m-b-0" id="history">



            <!-- <li class="clearfix">
                <div class="message-data-right">
                    <span class="message-data-time">10:10 AM, Today</span>
                </div>
                <div class="message other-message float-right"> Hi Aiden, how are you? How is the project coming along? </div>
            </li>
            <li class="clearfix">
                <div class="message-data">
                    <span class="message-data-time">10:12 AM, Today</span>
                </div>
                <div class="message my-message">Are we meeting today?</div>                                    
            </li>                               
            <li class="clearfix">
                <div class="message-data">
                    <span class="message-data-time">10:15 AM, Today</span>
                </div>
                <div class="message my-message">Project has been already finished and I have results to show you.</div>
            </li> -->


        </ul>
    </div>
    <div class="chat-message clearfix">
        <div class="input-group mb-0">
            <div class="input-group-prepend">
                <span class="input-group-text"><i class="fa fa-send"></i></span>
            </div>
            <input type="text" id="input" class="form-control" placeholder="Enter text here...">                                    
        </div>
    </div>


<!-- add history -->
{% for message in messages %}
{% if message.user == request.user %}
<script>
    document.getElementById('history').innerHTML += '<li class="clearfix"><div class="message-data-right"><span class="message-data-time">{{ message.timestamp }}</span></div><div class="message other-message float-right"> {{ message.message }} </div></li>';
</script>
{% else %}
<script>
    document.getElementById('history').innerHTML += '<li class="clearfix"><div class="message-data"><span class="message-data-time">{{ message.timestamp }}</span></div><div class="message my-message"> {{ message.message }} </div></li>';
</script>
{% endif %}
{% endfor %}


<!-- required python variable to get from inside js func -->
{% comment %} Get data for username and chatbox name{% endcomment %}
{{ request.user.username|json_script:"user_username" }}
{{ connection_id|json_script:"room-name" }}


<!-- add chat messages func -->
<script>
    function addMessagestoChatBox(data){
        const user_username = JSON.parse(document.getElementById('user_username').textContent);
        if (user_username == data.username){
            document.getElementById('history').innerHTML += '<li class="clearfix"><div class="message-data-right"><span class="message-data-time">' + data.timestamp + '</span></div><div class="message other-message float-right"> ' + data.message + ' </div></li>';
        }
        else{
            document.getElementById('history').innerHTML += '<li class="clearfix"><div class="message-data"><span class="message-data-time">' + data.timestamp + '</span></div><div class="message my-message"> ' + data.message + ' </div></li>';
        }
    }
</script>


<!-- import chatSocket.js -->
<script type="text/javascript" src="{% static '../static/js/chatSocket.js' %}"></script>
